<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Safe Steps ‚Äî Family Emergency Sheet</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:Inter,-apple-system,sans-serif;background:#f0f2f5}
  @media print{
    *{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important;color-adjust:exact!important}
    @page{margin:0;size:letter portrait}
    .no-print{display:none!important}
    body{background:white!important;margin:0;padding:0}
    .page-wrap{padding:0!important;margin:0!important;max-width:100vw!important}
    #sheet{box-shadow:none!important;margin:0!important;border-radius:0!important;border:none!important;transform-origin:top left}
  }
</style>
</head>
<body>

<!-- DOWNLOAD BAR -->
<div class="no-print" style="background:#0b1e3d;padding:14px 24px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100">
  <div style="color:white;font-family:Georgia,serif;font-size:1rem;font-weight:800;letter-spacing:0.05em;text-transform:uppercase">
    Safe<span style="color:#c0181c">Steps</span> ‚Äî Family Emergency Sheet
  </div>
  <button onclick="window.print()" style="background:#c0181c;color:white;border:none;border-radius:7px;padding:10px 24px;font-size:0.85rem;font-weight:700;letter-spacing:0.06em;text-transform:uppercase;cursor:pointer;font-family:inherit">
    ‚¨á Download / Print PDF
  </button>
</div>

<div class="page-wrap" style="max-width:900px;margin:24px auto;padding:0 16px 48px">
  <div class="sheet-wrap" id="sheet" style="background:white;border:1px solid #c5cede;border-top:5px solid #0b1e3d;border-radius:4px;box-shadow:0 4px 24px rgba(0,0,0,0.10)">
    <!-- Sheet rendered by JS below -->
  </div>
</div>

<script>
// ‚îÄ‚îÄ THEME ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const NAV="#0b1e3d",RED="#c0181c",BLUE="#1a3a6b",STEEL="#2b4270";
const ICE="#e9eef7",RULE="#c5cede",LABEL="#5a6a85",TEXT="#141c2b";
const FILL="#f6f8fc",WHITE="#ffffff";
const LOGO="data:image/png;base64,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";

// ‚îÄ‚îÄ PARSE DATA ‚Äî checks injected params first, then URL params ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getParam(key){
  if(window.__SS_PARAMS__&&window.__SS_PARAMS__[key]!==undefined) return window.__SS_PARAMS__[key];
  try{return JSON.parse(decodeURIComponent(new URLSearchParams(window.location.search).get(key)||"null"));}
  catch{return null;}
}

const address   = getParam("address")  || {street:"",city:"",state:"",zip:""};
const members   = getParam("members")  || [];
const er        = getParam("er")       || null;
const uc        = getParam("uc")       || [];
const contacts  = getParam("contacts") || {};
const pets      = getParam("pets")     || [];
const shutoffs  = getParam("shutoffs") || {gas:"",elec:"",water:""};
const selUtils  = getParam("selUtils") || {gas:null,elec:null,water:null};
const utilData  = getParam("utilData") || {gas:[],elec:[],water:[]};
const manUtils  = getParam("manUtils") || {gas:{name:"",phone:""},elec:{name:"",phone:""},water:{name:"",phone:""}};

// ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function gP(k){const s=selUtils[k];if(s==="na"||s===null)return null;return(utilData[k]||[])[s]?.p||manUtils[k]?.phone||null;}
function gN(k){const s=selUtils[k];if(s==="na"||s===null)return null;return(utilData[k]||[])[s]?.n||manUtils[k]?.name||null;}

function cell(label,value){
  return `<div style="display:flex;flex-direction:column;gap:2px;margin-bottom:5px">
    <div style="font-size:0.46rem;font-weight:700;letter-spacing:0.14em;text-transform:uppercase;color:${LABEL}">${label}</div>
    <div style="font-size:0.72rem;border-bottom:1px solid ${RULE};padding-bottom:2px;min-height:15px;color:${value?TEXT:"#ccc"};font-style:${value?"normal":"italic"}">${value||"‚Äî"}</div>
  </div>`;
}

function sectionHeader(text){
  return `<div style="background:${NAV};color:white;font-weight:700;font-size:0.6rem;letter-spacing:0.14em;text-transform:uppercase;padding:3px 20px 3px 9px;margin-bottom:8px;display:inline-block;clip-path:polygon(0 0,calc(100% - 7px) 0,100% 50%,calc(100% - 7px) 100%,0 100%)">${text}</div>`;
}

function card(content,bg=FILL,border=RULE,extraStyle=""){
  return `<div style="border:1.5px solid ${border};border-radius:4px;padding:8px 10px;background:${bg};${extraStyle}">${content}</div>`;
}

function cardLabel(text,color=BLUE){
  return `<div style="font-size:0.5rem;font-weight:700;letter-spacing:0.14em;text-transform:uppercase;color:${color};border-bottom:1px solid ${RULE};padding-bottom:3px;margin-bottom:6px">${text}</div>`;
}

// ‚îÄ‚îÄ BUILD SHEET HTML ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function buildSheet(){
  const fullAddr=[address.street,address.city,address.state,address.zip].filter(Boolean).join(", ");

  // MASTHEAD
  let html=`
  <div style="background:${NAV};padding:11px 20px;display:flex;align-items:center;justify-content:space-between">
    <div style="display:flex;flex-direction:column;align-items:flex-start">
      <img src="${LOGO}" alt="Safe Steps" style="height:42px;display:block;border-radius:4px;padding:3px 7px;background:white"/>
      <div style="font-size:0.46rem;letter-spacing:0.18em;text-transform:uppercase;color:#7a9ac8;margin-top:5px">Veteran-Built Home Preparedness</div>
    </div>
    <div style="text-align:right">
      <div style="font-family:Georgia,serif;font-size:1.05rem;font-weight:800;letter-spacing:0.05em;text-transform:uppercase;color:white">Family Emergency Sheet</div>
      <span style="background:${RED};color:white;font-size:0.44rem;font-weight:700;letter-spacing:0.2em;text-transform:uppercase;padding:2px 9px;border-radius:20px;display:inline-block;margin-top:3px">Post on Refrigerator</span>
    </div>
  </div>`;

  html+=`<div style="padding:13px 20px 16px">`;

  // ADDRESS
  html+=`
  <div style="background:${ICE};border:1.5px solid ${RULE};border-left:5px solid ${RED};padding:7px 11px;margin-bottom:11px;display:flex;align-items:center;gap:9px">
    <span style="font-size:1.1rem;opacity:0.6">üìç</span>
    <div style="flex:1">
      <div style="font-size:0.46rem;font-weight:700;letter-spacing:0.2em;text-transform:uppercase;color:${RED};margin-bottom:4px">Home Address</div>
      <div style="display:grid;grid-template-columns:2fr 1fr 0.5fr 0.6fr;gap:7px">
        ${cell("Street Address",address.street)}
        ${cell("City",address.city)}
        ${cell("State",address.state)}
        ${cell("Zip",address.zip)}
      </div>
    </div>
  </div>`;

  // FAMILY
  html+=`<div style="margin-bottom:11px">${sectionHeader("Family Members")}
  <div style="overflow-x:auto">
  <table style="width:100%;border-collapse:collapse;font-size:0.65rem">
  <thead><tr>
    ${["#","Full Name","Role","Age","Hair","Eyes","Defining Feature / Mark","Allergies","Medications","Disability / Medical Condition"].map(h=>`<th style="background:${STEEL};color:#d0ddf0;font-size:0.48rem;font-weight:700;letter-spacing:0.12em;text-transform:uppercase;padding:5px 6px;text-align:left;border:1px solid #1e3260">${h}</th>`).join("")}
  </tr></thead>
  <tbody>
    ${members.filter(m=>m.name).map((m,i)=>`
    <tr style="background:${i%2===1?FILL:WHITE}">
      <td style="background:${ICE};color:${STEEL};font-weight:700;font-size:0.58rem;text-align:center;padding:5px 6px;border:1px solid ${RULE};width:26px">${i+1}</td>
      ${["name","role","age","hair","eyes","mark","allergies","medications","conditions"].map(k=>`<td style="border:1px solid ${RULE};padding:3px 5px;font-size:0.65rem">${m[k]||"‚Äî"}</td>`).join("")}
    </tr>`).join("")}
  </tbody>
  </table></div></div>`;

  // MEDICAL FACILITIES
  html+=`<div style="margin-bottom:11px">${sectionHeader("Nearest Medical Facilities")}
  <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:7px">
    ${card(cardLabel("üöë Emergency Room","#a01020")+cell("Name",er?.name)+cell("Address",er?.address)+cell("Phone",er?.phone),"#fff4f4","#e0a0a0")}
    ${card(cardLabel("‚ûï Urgent Care 1")+cell("Name",uc[0]?.name)+cell("Address",uc[0]?.address)+cell("Phone",uc[0]?.phone))}
    ${card(cardLabel("‚ûï Urgent Care 2")+cell("Name",uc[1]?.name)+cell("Address",uc[1]?.address)+cell("Phone",uc[1]?.phone))}
  </div></div>`;

  // CONTACTS
  html+=`<div style="margin-bottom:11px">${sectionHeader("Emergency Contacts")}
  <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:7px">
    ${card(cardLabel("Family Contact 1",BLUE)+cell("Name",contacts.fam1?.name)+cell("Phone",contacts.fam1?.phone)+cell("Relationship",contacts.fam1?.rel))}
    ${card(cardLabel("Family Contact 2",BLUE)+cell("Name",contacts.fam2?.name)+cell("Phone",contacts.fam2?.phone)+cell("Relationship",contacts.fam2?.rel))}
    ${card(cardLabel("Neighbor / Local",STEEL)+cell("Name",contacts.neighbor?.name)+cell("Phone",contacts.neighbor?.phone)+cell("Relationship",contacts.neighbor?.rel))}
  </div></div>`;

  // PETS
  const activePets=pets.filter(p=>p.name);
  if(activePets.length>0){
    html+=`<div style="margin-bottom:11px">${sectionHeader("Pets")}
    <table style="width:100%;border-collapse:collapse;font-size:0.65rem">
    <thead><tr>
      ${["#","Name","Species / Breed","Color / Markings","Normally Located","Special Notes"].map(h=>`<th style="background:${STEEL};color:#d0ddf0;font-size:0.48rem;font-weight:700;letter-spacing:0.12em;text-transform:uppercase;padding:5px 6px;text-align:left;border:1px solid #1e3260">${h}</th>`).join("")}
    </tr></thead>
    <tbody>
      ${activePets.map((p,i)=>`
      <tr style="background:${i%2===1?FILL:WHITE}">
        <td style="background:${ICE};color:${STEEL};font-weight:700;font-size:0.58rem;text-align:center;padding:5px 6px;border:1px solid ${RULE};width:26px">${i+1}</td>
        ${["name","breed","color","location","notes"].map(k=>`<td style="border:1px solid ${RULE};padding:3px 5px">${p[k]||"‚Äî"}</td>`).join("")}
      </tr>`).join("")}
    </tbody></table></div>`;
  }

  // UTILITIES + PHONE NUMBERS
  html+=`<div style="display:grid;grid-template-columns:1fr 1fr;gap:11px;margin-bottom:11px">
  <div>${sectionHeader("Utility Shutoffs")}
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;align-items:stretch">
      ${[{k:"gas",lb:"üî• Gas Meter",c:"#8a4010",bg:"#fff8f0",b:"#e8c090"},
         {k:"elec",lb:"‚ö° Electrical Panel",c:"#6a6010",bg:"#f8f8f0",b:"#d8d090"},
         {k:"water",lb:"üíß Water Main",c:"#1a3a7a",bg:"#f0f6ff",b:"#a0b8e0"}].map(u=>
        card(cardLabel(u.lb,u.c)+(selUtils[u.k]==="na"?`<div style="font-size:0.68rem;color:${LABEL};font-style:italic">No ${u.k==="elec"?"electricity":u.k}</div>`:cell("Location",shutoffs[u.k])),u.bg,u.b)
      ).join("")}
    </div>
  </div>
  <div>${sectionHeader("Important Phone Numbers")}
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;align-items:stretch">
      ${card(`${cardLabel("‚ò£ Poison Control","#a01020")}<div style="font-weight:700;color:${RED};font-size:0.76rem">(800) 222-1222</div>`,"#fff8f8","#f0c0c0")}
      ${card(`${cardLabel("üî• Gas Emergency","#8a4010")}${selUtils.gas==="na"?`<div style="font-size:0.66rem;color:${LABEL};font-style:italic">N/A</div>`:`<div style="font-weight:700;font-size:0.76rem;color:#8a4010">${gP("gas")||"‚Äî"}</div><div style="font-size:0.58rem;color:${LABEL}">${gN("gas")||""}</div>`}`,"#fff8f0","#e8c090")}
      ${card(`${cardLabel("‚ö° Power Outage","#6a6010")}${selUtils.elec==="na"?`<div style="font-size:0.66rem;color:${LABEL};font-style:italic">N/A</div>`:`<div style="font-weight:700;font-size:0.76rem;color:#6a6010">${gP("elec")||"‚Äî"}</div><div style="font-size:0.58rem;color:${LABEL}">${gN("elec")||""}</div>`}`,"#f8f8f0","#d8d090")}
    </div>
  </div></div>`;

  // ADDITIONAL INFO
  html+=`<div>${sectionHeader("Additional Info")}
  <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:7px">
    ${card(`<div style="display:flex;align-items:center;gap:7px"><span style="font-size:1.2rem;opacity:0.55;flex-shrink:0">üè†</span><div style="flex:1">${cardLabel("Primary Rally Point","#2a6040")}${cell("Location",contacts.rally1)}</div></div>`,"#f0f8f0","#a0c8a0")}
    ${card(`<div style="display:flex;align-items:center;gap:7px"><span style="font-size:1.2rem;opacity:0.55;flex-shrink:0">üå≤</span><div style="flex:1">${cardLabel("Alternate Rally Point","#4a6030")}${cell("Location",contacts.rally2)}</div></div>`,"#f6f8f0","#b8c8a0")}
    ${card(`${cardLabel("üîí Family Password","#7a5a10")}<div style="font-size:0.9rem;font-weight:700;color:#5a3a08;letter-spacing:0.1em;margin-top:3px">${contacts.password||"‚Äî"}</div>`,"#fffaf0","#e8d8a0")}
  </div></div>`;

  html+=`</div>`;

  // FOOTER
  html+=`
  <div style="background:${NAV};padding:6px 20px;display:flex;justify-content:space-between;align-items:center">
    <div>
      <div style="font-size:0.46rem;color:#5a7aaa">Prepared by Safe Steps | Your Trusted Partner in Family Protection</div>
      <div style="font-weight:700;font-size:0.62rem;color:#7a9ac8;letter-spacing:0.08em">safestepsplans.com</div>
    </div>
    <div style="font-size:0.46rem;color:#5a7aaa">Last Updated: ${new Date().toLocaleDateString()}</div>
  </div>`;

  return html;
}

document.getElementById("sheet").innerHTML=buildSheet();
</script>

<script>
function scaleSheetForPrint(){
  const sheet=document.getElementById("sheet");
  if(!sheet)return;
  // Letter page at 96dpi = 816x1056px, minus 0 margins
  const pageH=1056;
  const pageW=816;
  const sheetH=sheet.scrollHeight;
  const sheetW=sheet.scrollWidth;
  const scaleH=pageH/sheetH;
  const scaleW=pageW/sheetW;
  const scale=Math.min(scaleH,scaleW,1); // never scale up, only down
  sheet.style.transform="scale("+scale+")";
  sheet.style.width=(100/scale)+"%";
}

// Run before printing
if(window.matchMedia){
  window.matchMedia("print").addListener(function(mq){
    if(mq.matches) scaleSheetForPrint();
    else{ 
      const sheet=document.getElementById("sheet");
      if(sheet){sheet.style.transform="";sheet.style.width="";}
    }
  });
}
window.onbeforeprint=scaleSheetForPrint;
window.onafterprint=function(){
  const sheet=document.getElementById("sheet");
  if(sheet){sheet.style.transform="";sheet.style.width="";}
};
</script>
</body>
</html>